<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="VAN_DS_SC_0340" classname="pattern_01" left="0" top="0" width="803" height="490" titletext="배송예정 상품별조회" onload="form_onload" oninit="form_init">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="30" left="0" top="29" right="15" height="119" cssclass="div_WFSA_Searchbg">
          <Layouts>
            <Layout>
              <Static id="Static04" taborder="59" text="조회일자" cssclass="sta_WFSA_Label" left="15" top="9" width="79" height="21"/>
              <Static id="Static06" taborder="60" text="20" visible="false" left="756" top="-2" right="201" height="69" style="background:#dc143c5b;"/>
              <Calendar id="cal_dvy_pla_dt_fr" taborder="72" dateformat="yyyy-MM-dd" left="94" top="9" width="100" height="21"/>
              <Static id="Static08" taborder="73" text="~" left="199" top="9" width="10" height="21"/>
              <Calendar id="cal_dvy_pla_dt_to" taborder="74" dateformat="yyyy-MM-dd" left="214" top="9" width="100" height="21"/>
              <Static id="Static00" taborder="91" text="10" visible="false" left="283" top="-1" right="355" height="10" style="background:#dc143c5b;"/>
              <Static id="Static05" taborder="103" text="상품코드" cssclass="sta_WFSA_Label" left="15" top="87" width="103" height="21"/>
              <Radio id="rdo_wrs_gubun" taborder="104" index="0" codecolumn="codecolumn" datacolumn="datacolumn" value="1" direction="vertical" left="123" top="87" width="156" height="21" style="font:9 Gulim;">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">상품코드</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Edit id="edt_na_wrs_c" taborder="105" cssclass="WF_Essential" left="285" top="87" width="122" height="21" onkeyup="div_search_edt_na_wrs_c_onkeyup" maxlength="25" inputtype="number"/>
              <Edit id="edt_na_wrs_n" taborder="106" cssclass="WF_Essential" left="409" top="87" width="169" height="21" onkeyup="div_search_edt_na_wrs_c_onkeyup"/>
              <Button id="btn_pup_van_seq00" taborder="107" onclick="btn_pup_van_seq_onclick" cssclass="btn_WF_Searchbtn" left="580" top="87" width="21" height="21"/>
              <Static id="Static03" taborder="122" text="조회구분" cssclass="sta_WFSA_Label" visible="false" left="344" top="9" width="102" height="21"/>
              <Radio id="rdo_spypl_type" taborder="123" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" onitemclick="div_search_rdo_spypl_type_onitemclick" visible="false" left="446" top="9" width="337" height="21" style="font:9 Gulim;">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">수주처+공급처</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">수주처</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">3</Col>
                      <Col id="datacolumn">공급처</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Static id="Static01" taborder="124" text="10" visible="false" left="275" top="108" right="363" height="10" style="background:#dc143c5b;"/>
              <Static id="Static02" taborder="125" text="배송예정서번호" cssclass="sta_WFSA_Label" left="15" top="33" width="115" height="21"/>
              <Radio id="rdo_dvy_plash_slpno" taborder="126" index="0" codecolumn="codecolumn" datacolumn="datacolumn" value="1" direction="vertical" left="123" top="33" width="156" height="21" style="font:9 Gulim;">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">배송예정서</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Edit id="edt_na_dvy_plash_slpno" taborder="127" cssclass="WF_Essential" left="285" top="33" width="148" height="21"/>
              <Button id="btn_pup_deliveryNotice" taborder="128" onclick="div_search_btn_pup_deliveryNotice_onclick" cssclass="btn_WF_Searchbtn" left="434" top="33" width="21" height="21"/>
              <Static id="Static07" taborder="129" text="발주처" cssclass="sta_WFSA_Label" left="15" top="60" width="103" height="21"/>
              <Radio id="rdo_odrpl_na_trpl_c" taborder="130" index="0" codecolumn="codecolumn" datacolumn="datacolumn" value="1" direction="vertical" left="123" top="60" width="156" height="21" style="font:9 Gulim;">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">발주처</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Edit id="edt_odrpl_na_trpl_c" taborder="131" onkeyup="div_search_edt_odrpl_na_trpl_c_onkeyup" cssclass="WF_Essential" left="285" top="59" width="122" height="21"/>
              <Edit id="edt_odrpl_na_trpl_n" taborder="132" onkeyup="div_search_edt_odrpl_na_trpl_n_onkeyup" cssclass="WF_Essential" left="409" top="59" width="169" height="21"/>
              <Button id="btn_trplO" taborder="133" onclick="div_search_btn_trplO_onclick" cssclass="btn_WF_Searchbtn" left="580" top="59" width="21" height="21"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_list" taborder="0" text="Div02" top="146" scrollbars="none" visible="true" right="15" bottom="2" onsize="Div00_onsize" left="0">
          <Layouts>
            <Layout width="978" height="800">
              <Div id="div_page01" taborder="40" url="common::pagingBTN.xfdl" top="151" height="44" style="align:center;" visible="false" left="28.55%" width="338"/>
              <Button id="Button10" taborder="23" cssclass="btn_WFSA_SearchClose" left="331" top="0" right="330" height="12" onclick="div_list_btn_divResize_onclick"/>
              <Grid id="grd_master" taborder="24" binddataset="ds_dataM" useinputpanel="false" left="0" top="20" right="0" height="131" onselectchanged="div_list_Grid00_onselectchanged" autofittype="none">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="39"/>
                      <Column size="120"/>
                      <Column size="250"/>
                      <Column size="90"/>
                      <Column size="90"/>
                      <Column size="140"/>
                      <Column size="140"/>
                      <Column size="140"/>
                      <Column size="120"/>
                      <Column size="200"/>
                      <Column size="120"/>
                      <Column size="200"/>
                      <Column size="140"/>
                      <Column size="140"/>
                      <Column size="140"/>
                      <Column size="140"/>
                    </Columns>
                    <Rows>
                      <Row size="30" band="head"/>
                      <Row size="28"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="순번"/>
                      <Cell col="1" text="상품코드"/>
                      <Cell col="2" text="상품명"/>
                      <Cell col="3" text="규격"/>
                      <Cell col="4" text="항목수"/>
                      <Cell col="5" text="총수량"/>
                      <Cell col="6" text="총금액"/>
                      <Cell col="7" text="부가세"/>
                      <Cell col="8" text="공급업체코드"/>
                      <Cell col="9" text="공급업체명"/>
                      <Cell col="10" text="수주처코드"/>
                      <Cell col="11" text="수주처명"/>
                      <Cell col="12" text="수주처팀"/>
                      <Cell col="13" text="지방소주여부"/>
                      <Cell col="14" text="차량번호"/>
                      <Cell col="15" text="배송예정상태"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:RN"/>
                      <Cell col="1" text="bind:NA_WRS_C"/>
                      <Cell col="2" cssclass="Cellgrd_WF_AlignLeft" text="bind:WRSNM"/>
                      <Cell col="3" text="bind:WRS_STDNM"/>
                      <Cell col="4" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:CNT" mask="#,##0"/>
                      <Cell col="5" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_PLA_QT" mask="#,##0"/>
                      <Cell col="6" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_AM" mask="#,##0"/>
                      <Cell col="7" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_VAT" mask="#,##0"/>
                      <Cell col="8" text="bind:SPYPL_NA_TRPL_C"/>
                      <Cell col="9" text="bind:SPYPL_NA_TRPL_N"/>
                      <Cell col="10" text="bind:RVOPL_NA_TRPL_C"/>
                      <Cell col="11" text="bind:RVOPL_NA_TRPL_N"/>
                      <Cell col="12" expr="expr:RVOPL_NA_TEAM_C == '00' ? '팀없음' : RVOPL_NA_TEAM_C"/>
                      <Cell col="13" expr="expr:GRS_SOJU_YN == '1' ? '여' : '부'"/>
                      <Cell col="14" text="bind:VHCNO"/>
                      <Cell col="15" text="bind:DVY_PLASH_STAC"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Grid id="grd_detail" taborder="26" useinputpanel="false" left="0" right="0" binddataset="ds_dataD" useselcolor="true" top="202" bottom="42">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="39"/>
                      <Column size="120"/>
                      <Column size="200"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="200"/>
                      <Column size="120"/>
                      <Column size="200"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="120"/>
                      <Column size="120"/>
                    </Columns>
                    <Rows>
                      <Row size="30" band="head"/>
                      <Row size="28"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="순번"/>
                      <Cell col="1" text="수주처"/>
                      <Cell col="2" text="수주처명"/>
                      <Cell col="3" text="배송예정서번호"/>
                      <Cell col="4" text="배송지"/>
                      <Cell col="5" text="배송지명"/>
                      <Cell col="6" text="발주처"/>
                      <Cell col="7" text="발주처명"/>
                      <Cell col="8" text="발주처팀"/>
                      <Cell col="9" text="배송예정일"/>
                      <Cell col="10" text="단가"/>
                      <Cell col="11" text="수량"/>
                      <Cell col="12" text="배송금액"/>
                      <Cell col="13" text="부가세"/>
                      <Cell col="14" text="수수료(물류,환급)"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:RN"/>
                      <Cell col="1" text="bind:RVOPL_NA_TRPL_C"/>
                      <Cell col="2" cssclass="Cellgrd_WF_AlignLeft" text="bind:RVOPL_NA_TRPL_N"/>
                      <Cell col="3" text="bind:NA_DVY_PLASH_SLPNO"/>
                      <Cell col="4" text="bind:DVYAA_NA_TRPL_C"/>
                      <Cell col="5" cssclass="Cellgrd_WF_AlignLeft" text="bind:DVYAA_NA_TRPL_N"/>
                      <Cell col="6" text="bind:ODRPL_NA_TRPL_C"/>
                      <Cell col="7" cssclass="Cellgrd_WF_AlignLeft" text="bind:ODRPL_NA_TRPL_N"/>
                      <Cell col="8" text="bind:ODRPL_NA_TEAM_C"/>
                      <Cell col="9" displaytype="date" text="bind:DVY_PLA_DT" mask="yyyy-MM-dd" calendardisplaynulltype="none"/>
                      <Cell col="10" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_WRS_UPR" mask="#,##0"/>
                      <Cell col="11" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_PLA_QT" mask="#,##0"/>
                      <Cell col="12" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_AM" mask="#,##0"/>
                      <Cell col="13" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_VAT" mask="#,##0"/>
                      <Cell col="14" displaytype="number" cssclass="Cellgrd_WF_AlignRight" text="bind:DVY_FEE" mask="#,##0"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static02" taborder="32" text="15" visible="false" left="936" top="-1" right="2" height="15" style="background:#dc143c5b;"/>
              <Static id="Static07" taborder="34" text="5" visible="false" left="936" top="35" right="2" height="5" style="background:#dc143c5b;"/>
              <Static id="Static00" taborder="42" text="5" visible="false" left="0" top="0" right="0" height="20" style="background:#dc143c5b;"/>
              <Div id="div_page02" taborder="41" url="common::pagingBTN.xfdl" style="align:center;" visible="false" left="28.55%" bottom="0" height="29" width="338">
                <Layouts>
                  <Layout/>
                </Layouts>
              </Div>
              <Button id="btn_tr_print" taborder="43" text="거래명세서출력" onclick="btn_tr_print_onclick" top="176" right="0" height="22" width="101"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="Div01" taborder="2" url="common::location.xfdl" text="Div01" left="0" top="0" height="21" width="397"/>
        <Static id="Static09" taborder="7" text="15" visible="false" left="1" top="30" right="977" height="69" style="background:#dc143c5b;"/>
        <Static id="Static10" taborder="8" text="22" visible="false" left="85" top="30" right="886" height="69" style="background:#dc143c5b;"/>
        <Static id="Static05" taborder="13" text="15" visible="false" left="788" top="0" width="15" height="490" style="background:#00ffffb5;"/>
        <Static id="Static02" taborder="15" text="15" visible="false" left="923" top="308" right="15" height="15" style="background:#dc143c5b;"/>
        <Static id="Static07" taborder="16" text="5" visible="false" left="923" top="344" right="15" height="5" style="background:#dc143c5b;"/>
        <Button id="btn_search" taborder="41" cssclass="btn_WFSA_Searchbtn" top="0" right="15" width="58" height="21" onclick="btn_search_onclick"/>
        <Static id="Static01" taborder="43" cssclass="sta_WF_Vdash" top="5" right="215" width="5" height="11"/>
        <Button id="btn_excel" taborder="47" text="엑셀" cssclass="btn_WF_CRUD" top="0" right="118" height="21" onclick="btn_excel_onclick" width="41"/>
        <Div id="div_auth" taborder="49" url="common::AuthorityWorkplace.xfdl" text="div_auth" top="0" right="257" width="431" height="21"/>
        <Button id="btn_print" taborder="50" text="출력" cssclass="btn_WF_CRUD" top="0" right="75" width="41" height="21" onclick="btn_print_onclick"/>
        <WebBrowser id="web_downExcel" left="641" top="22" width="44" height="14" taborder="51" visible="false"/>
        <Edit id="ozType" taborder="53" value="1" visible="false" left="816" top="75" width="44" height="16"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_pageVO01" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CURRENT_PAGE" type="STRING" size="256"/>
          <Column id="PAGE_SIZE" type="STRING" size="256"/>
          <Column id="TOTAL_ROW_COUNT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TOTAL_ROW_COUNT">0</Col>
            <Col id="PAGE_SIZE">10</Col>
            <Col id="CURRENT_PAGE">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_pageVO02" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CURRENT_PAGE" type="STRING" size="256"/>
          <Column id="PAGE_SIZE" type="STRING" size="256"/>
          <Column id="TOTAL_ROW_COUNT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TOTAL_ROW_COUNT">0</Col>
            <Col id="PAGE_SIZE">10</Col>
            <Col id="CURRENT_PAGE">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_dataM" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RN" type="STRING" size="256"/>
          <Column id="SPYPL_NA_TRPL_C" type="STRING" size="256"/>
          <Column id="RVOPL_NA_TRPL_C" type="STRING" size="256"/>
          <Column id="RVOPL_NA_TEAM_C" type="STRING" size="256"/>
          <Column id="NA_WRS_C" type="STRING" size="256"/>
          <Column id="WRSNM" type="STRING" size="256"/>
          <Column id="WRS_STDNM" type="STRING" size="256"/>
          <Column id="CNT" type="BIGDECIMAL" size="256"/>
          <Column id="DVY_PLA_QT" type="FLOAT" size="256"/>
          <Column id="DVY_AM" type="FLOAT" size="256"/>
          <Column id="DVY_VAT" type="BIGDECIMAL" size="256"/>
          <Column id="SPYPL_NA_TRPL_N" type="STRING" size="256"/>
          <Column id="RVOPL_NA_TRPL_N" type="STRING" size="256"/>
          <Column id="GRS_SOJU_YN" type="STRING" size="256"/>
          <Column id="VHCNO" type="STRING" size="256"/>
          <Column id="DVY_PLASH_STAC" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dataD" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RN" type="STRING" size="256"/>
          <Column id="RVOPL_NA_TRPL_C" type="STRING" size="256"/>
          <Column id="RVOPL_NA_TRPL_N" type="STRING" size="256"/>
          <Column id="NA_DVY_PLASH_SLPNO" type="STRING" size="256"/>
          <Column id="DVYAA_NA_TRPL_C" type="STRING" size="256"/>
          <Column id="DVYAA_NA_TRPL_N" type="STRING" size="256"/>
          <Column id="ODRPL_NA_TRPL_C" type="STRING" size="256"/>
          <Column id="ODRPL_NA_TRPL_N" type="STRING" size="256"/>
          <Column id="ODRPL_NA_TEAM_C" type="STRING" size="256"/>
          <Column id="DVY_PLA_DT" type="STRING" size="256"/>
          <Column id="DVY_WRS_UPR" type="STRING" size="256"/>
          <Column id="DVY_PLA_QT" type="STRING" size="256"/>
          <Column id="DVY_AM" type="STRING" size="256"/>
          <Column id="DVY_VAT" type="STRING" size="256"/>
          <Column id="DVY_FEE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ctr_tpc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SIMP_C" type="string" size="32"/>
          <Column id="SIMP_CNM" type="string" size="32"/>
          <Column id="SIMP_C_EXPL" type="string" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DVY_AM" type="BIGDECIMAL" size="256"/>
          <Column id="DVY_VAT" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript5.0"><![CDATA[include "lib::comLib.xjs";
/*##################################################################################
 화면ID 	: VAN_DS_SC_0340
 화면명	: 배송예정 상품별조회
 작성자	: swha
 작성일자	: 2015.08.26 
####################################################################################*/
/***************************************************************************************
	code        : 호출할 공통코드
	dsName      : 호출된 공통코드를 담을 Dataset
	selecttype  : ComboBox 최상단에 추가할 문구( A: -전체-, S:-선택-, N: 빈칸)
	 
	selecttype은 추후 변경될 수 있음.
	this.fn_commonAfterOnload를 화면에 선언하면 gfn_setCommonCode처리후 호출됨.
*****************************************************************************************/
/* form load */
this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{		
	this.gfn_setInitForm(obj,e);
	
	var ozParam = {
				form:this, 						//공통
				ozBtn:this.div_list.btn_tr_print, 		//출력버튼
				ozFnc:'btn_tr_print_onclick'	//오즈실행 함수명
			  };
    this.addOzBtnAdd(ozParam);
    
	this.authChkDisable();//권한사업장 체크박스 비활성화
}

/* Form Init*/
this.form_init = function(obj:Form, e:nexacro.InitEventInfo)
{	
	
}

//공통코드 데이터셋 onload후 호출할 함수
this.fn_commonAfterOnload= function()
{
	trace("fn_commonAfterOnload");

}

/* 페이지 로딩후 실행부분 */
this.fn_afterFormOnload = function()
{
	var param = {
		form: this,										//공통(필수)
		m_grd: this.div_list.grd_master,  				//마스터 그리드
		m_pageDiv: this.div_list.div_page01,		    //마스터 페이지DIV
		m_afterFnc: this.grd_afterFnc,					//마스터 그리드 클릭이벤트
		d_grd: this.div_list.grd_detail, 				//디테일 그리드
		d_pageDiv: this.div_list.div_page02		    //디테일 페이지DIV
	};
	
	param.m_pageDiv.addPageEvent(param);
	
	//그리드클릭 이벤트 등록
	//this.div_list.grd_master.addEventHandler("oncellclick", this.grd_afterFnc, this);
	
	//그리드 nodata
	this.div_list.grd_master.set_nodatatext(this.gfn_getTextMessage('result.message.search.no.exist.data'));
	this.div_list.grd_detail.set_nodatatext(this.gfn_getTextMessage('result.message.search.no.exist.data'));
	
	
	var today = this.gfn_today('yyyyMMdd');
	this.div_search.cal_dvy_pla_dt_fr.set_value(this.gfn_addDate(today, -1));	
	this.div_search.cal_dvy_pla_dt_to.set_value(this.gfn_addDate(today, 7));
	
	
	//this.div_search.cal_dvy_pla_dt_fr.set_value(this.gfn_minusDate(this.gfn_today("YYYYMMdd"),5));	
	//this.div_search.cal_dvy_pla_dt_to.set_value(this.gfn_lastDate(this.gfn_today("YYYYMMdd")));
}

/* search */
this.fn_searchFir = function(){
	//권한사업장 코드
	var trplC = this.getTrplCode();
	var dvy_pla_dt_fr		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_fr.value);//배송예정일자 from
	var dvy_pla_dt_to		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_to.value);//배송예정일자 to
	var wrs_gubun			= this.gfn_nullToEmpty(this.div_search.rdo_wrs_gubun.value); //상품코드구분
	var na_wrs_c			= this.gfn_nullToEmpty(this.div_search.edt_na_wrs_c.value); //상품코드
	var dvy_plash_slpno_rdo = this.gfn_nullToEmpty(this.div_search.rdo_dvy_plash_slpno.value);//배송예정서번호 구분
	var na_dvy_plash_slpno	= this.gfn_nullToEmpty(this.div_search.edt_na_dvy_plash_slpno.value);//배송예정서번호
	var odrpl_na_trpl_rdo	= this.gfn_nullToEmpty(this.div_search.rdo_odrpl_na_trpl_c.value);//발주처구분
	var odrpl_na_trpl_c		= this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_c.value);//발주처코드
	
	var params = 	" dvy_pla_dt_fr="+dvy_pla_dt_fr
					+" dvy_pla_dt_to="+dvy_pla_dt_to
					+" wrs_gubun="+wrs_gubun
					+" na_wrs_c="+na_wrs_c
					+" TRPL_C="+trplC
					+" dvy_plash_slpno_rdo="+dvy_plash_slpno_rdo
					+" na_dvy_plash_slpno="+na_dvy_plash_slpno
					+" odrpl_na_trpl_rdo="+odrpl_na_trpl_rdo
					+" odrpl_na_trpl_c="+odrpl_na_trpl_c;
					
					
					
	trace("##params >> " + params);
	
	var sSvcID        = "retrieveDeliverySkusM";//통신아이디
	var sURL          = "svc::rest/scm/delivery/retrieveDeliverySkusM";// 호출할 서버 페이지 주소
	var sInDatasets   = "ds_pageVO01=ds_pageVO01";//보내는데이터셋
	var sOutDatasets  = "ds_dataM=ds_dataM ds_pageVO01=ds_pageVO01";//화면에서 받는 데이터셋=보낸이름(1대1 맵핑)
	var sArgument     = params;// 파라미터
	var sCallbackFunc = "fn_callBack";//콜백
	var sTranType     = "S"; // U:저장/삭제, S:조회
	
	//API 호출
	this.gfn_callService(sSvcID, sURL, sInDatasets ,sOutDatasets , sArgument , sCallbackFunc, sTranType);	
	
}



this.btn_search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	

	this.ds_dataM.clearData();
	this.ds_dataD.clearData();
	this.div_list.div_page02.set_visible(false);
	if(this.fn_validationCheck())
		this.fn_paging(1, "div_page01"); 	
	

	
}

/* Validation Check */
this.fn_validationCheck = function(){
	
	
	if(this.gfn_isNull(this.div_search.cal_dvy_pla_dt_fr.value)){
		alert("조회기간(부터)를 확인하세요.");
		return false;
    }
    
    if(this.gfn_isNull(this.div_search.cal_dvy_pla_dt_to.value)){
		alert("조회기간(까지)를 확인하세요.");
		return false;
    }
    
    
	if(this.gfn_getDiffDay(this.div_search.cal_dvy_pla_dt_fr.value,this.div_search.cal_dvy_pla_dt_to.value) < 0){
		//조회 시작일과 종료일을 다시 확인해 주세요
		this.gfn_getMessage("alert", "validation.message.fromDate.toDate.reConfirm");
		return false;
	}else{
		/*
		if(this.gfn_getDiffDay(this.div_search.cal_dvy_pla_dt_fr.value,this.div_search.cal_dvy_pla_dt_to.value) > 31){
			//기간을 31일 이내로 선택해 주세요
			this.gfn_getMessage("alert", "validation.message.selectDateIn31Day");
			return false;
		}
		*/
	}
	
	if(this.gfn_nullToEmpty(this.div_search.rdo_wrs_gubun.value) == "2" && this.gfn_isNull(this.div_search.edt_na_wrs_c.value)){
		alert("상품코드를 선택해 주세요");
		return false;
	}
	
	if (this.gfn_nullToEmpty(this.div_search.rdo_dvy_plash_slpno.value) == "2" && this.gfn_isNull(this.div_search.edt_na_dvy_plash_slpno.value)) {
		alert("배송예정서를 선택해 주세요");
		return false;
	}

	if (this.gfn_nullToEmpty(this.div_search.rdo_odrpl_na_trpl_c.value) == "2" && this.gfn_isNull(this.div_search.edt_odrpl_na_trpl_c.value)) {
		alert("발주처를 선택해 주세요");
		return false;
	}
	
	return true;
}

/* Call Back */
this.fn_callBack = function(svcID, ErrorCode, ErrorMsg)
{	
	if(ErrorCode < 0)
	{
		this.gfn_getMessage("alert", ErrorMsg);
		return;
	}else{
		if(svcID == "retrieveDeliverySkusM"){		
			if(this.ds_dataM.rowcount > 0){
				trace(this.ds_dataM.saveXML());
				this.ds_dataM.set_enableevent(false);
				this.ds_dataM.set_rowposition(-1);
				this.ds_dataM.set_enableevent(true);
				var sTotal    = this.ds_pageVO01.getColumn(0, "TOTAL_ROW_COUNT");
				var sPagesize = this.ds_pageVO01.getColumn(0, "PAGE_SIZE");
				this.div_list.div_page01.fn_pageSet(sTotal, sPagesize,"grd_master,div_page01",lsNowPage);	
				
			}else{
				this.div_list.grd_master.set_nodatatext(this.gfn_getTextMessage('result.message.search.no.exist.data'));
				this.div_list.div_page01.fn_pageSet(0, 0,"grd_master,div_page01",lsNowPage);//페이징 설정
			}
			this.ds_dataD.clearData();
		}else if(svcID == "retrieveDeliverySkusD"){
			if(this.ds_dataD.rowcount > 0){
				var sTotal    = this.ds_pageVO02.getColumn(0, "TOTAL_ROW_COUNT");
				var sPagesize = this.ds_pageVO02.getColumn(0, "PAGE_SIZE");
				this.div_list.div_page02.fn_pageSet(sTotal, sPagesize,"grd_detail,div_page02",lsNowPage);	
				
			}else{
				
				this.div_list.grd_detail.set_nodatatext(this.gfn_getTextMessage('result.message.search.no.exist.data'));
				this.div_list.div_page02.fn_pageSet(0, 0,"grd_detail,div_page02",lsNowPage);//페이징 설정
				
			}
		}		
	}
}

//Popupdiv 호출
this.btn_excel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.fn_validationCheck())
		this.fn_excel();
}

this.fn_excel = function(){


	var trplC = this.getTrplCode();
	var dvy_pla_dt_fr		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_fr.value);//배송예정일자 from
	var dvy_pla_dt_to		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_to.value);//배송예정일자 to
	var wrs_gubun			= this.gfn_nullToEmpty(this.div_search.rdo_wrs_gubun.value); //상품코드구분
	var na_wrs_c			= this.gfn_nullToEmpty(this.div_search.edt_na_wrs_c.value); //상품코드
	var dvy_plash_slpno_rdo = this.gfn_nullToEmpty(this.div_search.rdo_dvy_plash_slpno.value);//배송예정서번호 구분
	var na_dvy_plash_slpno	= this.gfn_nullToEmpty(this.div_search.edt_na_dvy_plash_slpno.value);//배송예정서번호
	var odrpl_na_trpl_rdo	= this.gfn_nullToEmpty(this.div_search.rdo_odrpl_na_trpl_c.value);//발주처구분
	var odrpl_na_trpl_c		= this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_c.value);//발주처코드
	
	var FILE_NAME			= "배송예정 상품별 조회.xls";
	
	
	var params = 	"dvy_pla_dt_fr="+dvy_pla_dt_fr
					+"&dvy_pla_dt_to="+dvy_pla_dt_to
					+"&wrs_gubun="+wrs_gubun
					+"&na_wrs_c="+na_wrs_c
					+"&TRPL_C="+trplC
					+"&dvy_plash_slpno_rdo="+dvy_plash_slpno_rdo
					+"&na_dvy_plash_slpno="+na_dvy_plash_slpno
					+"&odrpl_na_trpl_rdo="+odrpl_na_trpl_rdo
					+"&odrpl_na_trpl_c="+odrpl_na_trpl_c
					+"&FILE_NAME="+ FILE_NAME;
		trace("엑셀 다운로드 params >>> " + params);
		//this.web_downExcel.set_url(application.gv_server_url+"rest/excel/scm/delivery/downloadExcelDeliverySkus?"+params);
		excelDownHandler(application.gv_server_url+"rest/excel/scm/delivery/downloadExcelDeliverySkus?"+params, this);
}


this.div_list_btn_divResize_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_searchDivResize(obj, this.div_search, this.div_list);
}


this.fn_popupAfter = function(strId, strVal)
{
	trace(" strId : " + strId + " strVal : " + strVal);
	if (this.gfn_isNull(strVal)) { return; }
	var paramsArr = strVal.split(",");
	if(strId == "POPUP_SRC_WRS"){
		this.div_search.edt_na_wrs_c.set_value(paramsArr[0]);
		this.div_search.edt_wrsnm.set_value(paramsArr[1]);
	}
	if (strId == "POPUP_TRNREL_ODRPL") {
		this.div_search.edt_odrpl_na_trpl_c.set_value(paramsArr[0]);
		this.div_search.edt_odrpl_na_trpl_n.set_value(paramsArr[1]);
	}
	if (strId == "VAN_DS_SC_0370_P01") {
		this.div_search.edt_na_dvy_plash_slpno.set_value(paramsArr[0]);
	}
}

/*-----------------------------------------------------------------------------------------*/
// 페이징처리
/*-----------------------------------------------------------------------------------------*/
this.fn_paging = function(vPageNum, objDivNm)
{ 	  	 
	
	var oDs, oBindDs;
	var searchLevel;
	if(this.gfn_isNull(objDivNm)){
		objDivNm = "div_page";
	}

	if(objDivNm == "div_page01"){
		oDs     = this.ds_pageVO01;
		oBindDs = this.ds_dataM;
		searchLevel = "F";//첫번째 그리드
	}else{
		oDs     = this.ds_pageVO02;
		oBindDs = this.ds_dataD;
		searchLevel = "S";//두번째 그리드
	}
	
	
	oDs.clearData();  
	oBindDs.clearData();     //Grid에 Binding된 Dataset명
	
	oDs.addRow(); 
	
	var vPageSize   = 15; 	//Grid에 보여줄 Row수, 화면에 따라 변경하여 사용
	var vTotalCount = 0; 	//전체건수. 화면조회후 리턴받아 사용
	
 	oDs.setColumn(0,"CURRENT_PAGE",vPageNum); //현재 페이지
 	oDs.setColumn(0,"PAGE_SIZE",vPageSize);
 	oDs.setColumn(0,"TOTAL_ROW_COUNT",vTotalCount);	 
	 
	var argumentObj = "";
	
	lsNowPage = vPageNum;//현재페이지 설정 
		
	if(searchLevel == "F"){
		//oDs.fn_pageSet(vTotalCount, vPageSize,objDivNm, lsNowPage);	
		this.fn_searchFir();
	}else{
		//oDs.fn_pageSet(vTotalCount, vPageSize,objDivNm, lsNowPage);	
		this.fn_searchScd();
	}
	
	
 
}


this.fn_searchScd = function(){

	//권한사업장 코드
	var trplC = this.getTrplCode();
	var dvy_pla_dt_fr		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_fr.value);//배송예정일자 from
	var dvy_pla_dt_to		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_to.value);//배송예정일자 to
	var na_wrs_c = this.gfn_nullToEmpty(this.ds_dataM.getColumn(this.ds_dataM.rowposition,"NA_WRS_C"));//상품코드
	var dvy_plash_slpno_rdo = this.gfn_nullToEmpty(this.div_search.rdo_dvy_plash_slpno.value);//배송예정서번호 구분
	var na_dvy_plash_slpno	= this.gfn_nullToEmpty(this.div_search.edt_na_dvy_plash_slpno.value);//배송예정서번호
	var odrpl_na_trpl_rdo	= this.gfn_nullToEmpty(this.div_search.rdo_odrpl_na_trpl_c.value);//발주처구분
	var odrpl_na_trpl_c		= this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_c.value);//발주처코드
	
	var params = 	" dvy_pla_dt_fr="+dvy_pla_dt_fr
					+" dvy_pla_dt_to="+dvy_pla_dt_to
					+" na_wrs_c="+na_wrs_c
					+" TRPL_C="+trplC					
					+" dvy_plash_slpno_rdo="+dvy_plash_slpno_rdo
					+" na_dvy_plash_slpno="+na_dvy_plash_slpno
					+" odrpl_na_trpl_rdo="+odrpl_na_trpl_rdo
					+" odrpl_na_trpl_c="+odrpl_na_trpl_c;
	
	
	trace("##PARAM##->"+params);
	
	var sSvcID        = "retrieveDeliverySkusD";//통신아이디
	var sURL          = "svc::rest/scm/delivery/retrieveDeliverySkusD";// 호출할 서버 페이지 주소
	var sInDatasets   = "ds_pageVO02=ds_pageVO02";//보내는데이터셋
	var sOutDatasets  = "ds_dataD=ds_dataD ds_pageVO02=ds_pageVO02";	//화면에서 받는 데이터셋=보낸이름(1대1 맵핑)
	var sArgument     = params;// 파라미터
	var sCallbackFunc = "fn_callBack";//콜백
	var sTranType     = "S"; // U:저장/삭제, S:조회
		
	//API 호출
	this.gfn_callService(sSvcID, sURL, sInDatasets ,sOutDatasets , sArgument , sCallbackFunc, sTranType);
}


this.grd_afterFnc = function(obj, e)
{
/*
	if(e.reason == 51)
	{		
		this.ds_dataD.set_enableevent(false);
		this.ds_dataD.set_rowposition(-1);
		this.ds_dataD.set_enableevent(true);
		return;
	}
*/	
	this.div_list.div_page02.set_visible(false);
	this.fn_paging(1, "div_page02"); 	
}
this.btn_pup_van_seq_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_enterWrs();
}

this.btn_print_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var trplC = this.getTrplCode();
	
	var dvy_pla_dt_fr		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_fr.value);//배송예정일자 from
	var dvy_pla_dt_to		= this.gfn_nullToEmpty(this.div_search.cal_dvy_pla_dt_to.value);//배송예정일자 to
	var wrs_gubun			= this.gfn_nullToEmpty(this.div_search.rdo_wrs_gubun.value); //상품코드구분
	var na_wrs_c			= this.gfn_nullToEmpty(this.div_search.edt_na_wrs_c.value); //상품코드
	var dvy_plash_slpno_rdo = this.gfn_nullToEmpty(this.div_search.rdo_dvy_plash_slpno.value);//배송예정서번호 구분
	var na_dvy_plash_slpno	= this.gfn_nullToEmpty(this.div_search.edt_na_dvy_plash_slpno.value);//배송예정서번호
	var odrpl_na_trpl_rdo	= this.gfn_nullToEmpty(this.div_search.rdo_odrpl_na_trpl_c.value);//발주처구분
	var odrpl_na_trpl_c		= this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_c.value);//발주처코드
	
	var searchText = "배송예정일자 ["+dvy_pla_dt_fr+" ~ "+dvy_pla_dt_to+"]";
	
	trace(searchText);
	
	var param = {
		TRPL_C_TEXT:searchText,
		dvyPlaDtFr:dvy_pla_dt_fr,
		dvyPlaDtTo:dvy_pla_dt_to,
		wrsGubun:wrs_gubun,
		naWrsC:na_wrs_c,
		dvyPlashSlpnoRdo:dvy_plash_slpno_rdo, 
		naDvyPlashSlpno:na_dvy_plash_slpno, 
		odrplNaTrplRdo:odrpl_na_trpl_rdo, 
		odrplNaTrplC:odrpl_na_trpl_c, 
		TRPL_C:trplC
	};
	
	var ozParam = {
		sId: 'VAN_DS_SC_0340',
		sUrl: '/rest/oz/scm/delivery/printDeliverySkus',
		paramType: 'param',
		sParam: param
	};
	this.ozViewer(ozParam);
}

this.div_search_edt_na_wrs_c_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	
	if(e.keycode==13)
	this.fn_enterWrs(true);
}

this.fn_enterWrs = function(param){
	var params = {
            autoType:param,
            searchCode:this.gfn_nullToEmpty(this.div_search.edt_na_wrs_c.value),
            searchText:this.gfn_nullToEmpty(this.div_search.edt_na_wrs_n.value)
	}
	if(typeof param == "boolean"){
      if(!this.searPopValue(params)){return};
	}
   
	var oArg = {autoPop:params};
	var sOption = "autosize=true, titleText=false";
	var sPopupCallBack = "fn_popupAfter";    
	this.gfn_openPopup("POPUP_SRC_WRS","POPUP::POPUP_SRC_WRS.xfdl",oArg,sOption,sPopupCallBack);
}

this.div_search_btn_pup_deliveryNotice_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	var oArg = {form_id:"VAN_DS_SC_0330", trplC:this.getTrplCode(), temp_yn:'N', sts:'all'};
	var sOption = "autosize=true, title=false";
	var sPopupCallBack = "fn_popupAfter";
	this.gfn_openPopup("VAN_DS_SC_0370_P01", "SCM.DELIVERY::VAN_DS_SC_0370_P01.xfdl", oArg, sOption, sPopupCallBack);
}

this.div_search_btn_trplO_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	var oArg = {form_id:"VAN_DS_SC_0340", trplC:this.getTrplCode()};
	var sOption = "autosize=true, title=false";
	var sPopupCallBack = "fn_popupAfter";
	this.gfn_openPopup("POPUP_TRNREL_ODRPL", "POPUP::POPUP_TRNREL_ODRPL.xfdl", oArg, sOption, sPopupCallBack);
}

this.btn_tr_print_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{						
	
	if (this.ds_dataD.rowposition == -1) {
		alert("배송예정서를 선택해 주세요");
		return false;
	}
	var trplC				= this.gfn_nullToEmpty(this.ds_dataD.getColumn(this.ds_dataD.rowposition, "RVOPL_NA_TRPL_C"));//수주처
	var dvy_pla_dt			= this.gfn_nullToEmpty(this.ds_dataD.getColumn(this.ds_dataD.rowposition, "DVY_PLA_DT"));//배송예정일자
	var dvy_plash_slpno_rdo	= "2";
	var na_dvy_plash_slpno 	= this.gfn_nullToEmpty(this.ds_dataD.getColumn(this.ds_dataD.rowposition, "NA_DVY_PLASH_SLPNO")); //배송예정서번호
	var odrpl_na_trpl_rdo 	= "2";
	var odrpl_na_trpl_c 	= this.gfn_nullToEmpty(this.ds_dataD.getColumn(this.ds_dataD.rowposition, "ODRPL_NA_TRPL_C")); //발주처코드
	var ozType 				= this.ozType.value;
	
	var searchText = "배송예정일자 ["+dvy_pla_dt+"]";
	
	trace(searchText);
	
	var param = {
		TRPL_C_TEXT:searchText,
		dvyPlaDt:dvy_pla_dt,
		dvyPlashSlpnoRdo:dvy_plash_slpno_rdo, 
		naDvyPlashSlpno:na_dvy_plash_slpno,
		odrplNaTrplRdo:odrpl_na_trpl_rdo,
		odrplNaTrplC:odrpl_na_trpl_c, 
		TRPL_C:trplC, 
		ozType:ozType
	};
	
	var ozParam = {
		sId: 'VAN_DS_SC_0300', 
		sUrl: '/rest/oz/delivery/printDeliveryNoticeSkus', 
		paramType: 'param', 
		sParam: param
	};
	// trace("거래명세표 출력");
	this.ozType.set_value('1');
	this.ozViewer(ozParam);
}

this.div_search_edt_odrpl_na_trpl_c_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if (e.keycode == '13') {
		var trplO = this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_c.value);
		if (this.gfn_length(trplO) < 6) {
			alert("발주처 코드["+trplO+"] 6자리 이상 입력해 주세요");
			return false;
		}

		if (trplO.length == 6) {
			trplO = '8808983' + trplO;
		}

		var idx = "0";
		var trplC = this.getTrplCode();//권한사업장
		var oArg = {form_id:"VAN_DS_SC_0340", trplC:trplC, idx:idx, auto:"1", trplO:trplO};
		var sOption = "autosize=true, title=false";
		var sPopupCallBack = "fn_popupAfter";
		this.gfn_openPopup("POPUP_TRNREL_ODRPL", "POPUP::POPUP_TRNREL_ODRPL.xfdl", oArg, sOption, sPopupCallBack);
	}
}

this.div_search_edt_odrpl_na_trpl_n_onkeyup = function(obj:Edit, e:nexacro.KeyEventInfo)
{
	if (e.keycode == "13") {
		var trplON = this.gfn_nullToEmpty(this.div_search.edt_odrpl_na_trpl_n.value);
		if (this.gfn_length(trplON) < 3) {
			alert("발주처명["+trplON+"] 3자리 이상 입력해 주세요");
			return false;
		}

		var idx = "1";
		var trplC = this.getTrplCode();//권한사업장
		var oArg = {form_id:"VAN_DS_SC_0340", trplC:trplC, idx:idx, auto:"1", trplON:trplON};
		var sOption = "autosize=true, title=false";
		var sPopupCallBack = "fn_popupAfter";
		this.gfn_openPopup("POPUP_TRNREL_ODRPL", "POPUP::POPUP_TRNREL_ODRPL.xfdl", oArg, sOption, sPopupCallBack);
	}
}
]]></Script>
  </Form>
</FDL>
